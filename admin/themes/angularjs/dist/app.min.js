"use strict";!function(){function t(t,e,r){r.otherwise("/posts"),e.state("posts",{url:"/posts",abstract:!0,template:"<ui-view />",data:{area:"site-admin",section:"posts"}}).state("posts.list",{url:"",templateUrl:"posts/index.view.html",controller:"Posts.IndexController",controllerAs:"vm"}).state("posts.add-edit",{url:"/{action:add|edit}/:_id",params:{_id:{squash:!0,value:null}},templateUrl:"posts/add-edit.view.html",controller:"Posts.AddEditController",controllerAs:"vm"}).state("pages",{url:"/pages",abstract:!0,template:"<ui-view />",data:{area:"site-admin",section:"pages"}}).state("pages.list",{url:"",templateUrl:"pages/index.view.html",controller:"Pages.IndexController",controllerAs:"vm"}).state("pages.add-edit",{url:"/{action:add|edit}/:_id",params:{_id:{squash:!0,value:null}},templateUrl:"pages/add-edit.view.html",controller:"Pages.AddEditController",controllerAs:"vm"}).state("redirects",{url:"/redirects",abstract:!0,template:"<ui-view />",data:{area:"site-admin",section:"redirects"}}).state("redirects.list",{url:"",templateUrl:"redirects/index.view.html",controller:"Redirects.IndexController",controllerAs:"vm"}).state("redirects.add-edit",{url:"/{action:add|edit}/:_id",params:{_id:{squash:!0,value:null}},templateUrl:"redirects/add-edit.view.html",controller:"Redirects.AddEditController",controllerAs:"vm"}).state("account",{url:"/account",templateUrl:"account/index.view.html",controller:"Account.IndexController",controllerAs:"vm",data:{area:"account"}}).state("sites",{url:"/sites",abstract:!0,template:"<ui-view />",data:{area:"system-admin",section:"sites"}}).state("sites.list",{url:"",templateUrl:"sites/index.view.html",controller:"Sites.IndexController",controllerAs:"vm"}).state("sites.add-edit",{url:"/{action:add|edit}/:_id",params:{_id:{squash:!0,value:null}},templateUrl:"sites/add-edit.view.html",controller:"Sites.AddEditController",controllerAs:"vm"}).state("users",{url:"/users",abstract:!0,template:"<ui-view />",data:{area:"system-admin",section:"users"}}).state("users.list",{url:"",templateUrl:"users/index.view.html",controller:"Users.IndexController",controllerAs:"vm"}).state("users.add-edit",{url:"/{action:add|edit}/:_id",params:{_id:{squash:!0,value:null}},templateUrl:"users/add-edit.view.html",controller:"Users.AddEditController",controllerAs:"vm"})}function e(e,t,r,s,l){var i=t.globals={};e.defaults.headers.common.Authorization="Bearer "+r.currentUser.token;var a=localStorage.getItem("siteId")||r.currentUser.sites[0]._id;e.defaults.headers.common["MEANie-Site-Id"]=a,i.currentUser=r.currentUser,i.currentSite=r.currentUser.sites.filter(function(t){return t._id===a})[0],i.switchSite=function(t){i.showSiteSelector=!1,i.currentSite=t,localStorage.setItem("siteId",t._id),e.defaults.headers.common["MEANie-Site-Id"]=t._id,s.reload()},t.$on("$stateChangeStart",function(t,e,r,s,a){"system-admin"!==(e.data||{}).area||i.currentUser.isSystemAdmin||(t.preventDefault(),l.path("/"))}),t.$on("$stateChangeSuccess",function(t,e,r,s,a){var l=e.data||{};i.area=l.area,i.section=l.section})}t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"],e.$inject=["$http","$rootScope","$window","$state","$location"],angular.module("app",["ui.router"]).config(t).run(e),$(function(){$.get("/current-user",function(t){window.currentUser=t,angular.bootstrap(document,["app"])})})}();
"use strict";!function(){function t(t){return{require:"ngModel",link:function(t,e,r,n){e.addClass("datepicker"),e.datepicker({dateFormat:"dd/mm/yy"}),n.$formatters.push(function(t){if(t)return moment(t).format("DD/MM/YYYY")}),n.$parsers.push(function(t){if(t)return moment(t,"DD/MM/YYYY").format("YYYY-MM-DD")})}}}t.$inject=["$filter"],angular.module("app").directive("datepicker",t)}();
"use strict";!function(){function n(e){return{require:"ngModel",link:function(n,r,t,u){u.$formatters.push(function(n){return e("csv")(n)}),u.$parsers.push(function(n){var r=_.map(n.split(","),function(n){return n.trim()});return r=_.filter(r,function(n){return n})})}}}n.$inject=["$filter"],angular.module("app").directive("tags",n)}();
"use strict";!function(){function e(e){return{require:"ngModel",link:function(e,i,t,n){var a;a="minimal"===t.wysiwyg?{height:100,toolbar:[{name:"basic",items:["Bold","Italic","Underline"]},{name:"links",items:["Link","Unlink"]},{name:"tools",items:["Maximize"]},{name:"document",items:["Source"]}],removePlugins:"elementspath",resize_enabled:!1,allowedContent:!0}:{filebrowserImageUploadUrl:"/admin/upload",removeButtons:"About,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Save,CreateDiv,Language,BidiLtr,BidiRtl,Flash,Iframe,addFile,Styles",allowedContent:!0},i.ckeditor(a).editor.on("change",function(){n.$setViewValue(this.getData())})}}}e.$inject=["$rootScope"],angular.module("app").directive("wysiwyg",e)}();
"use strict";angular.module("app").filter("csv",function(){return function(r){if(r)return r.toString().replace(/,/g,", ")}});
"use strict";angular.module("app").filter("slugify",function(){return function(r){if(r){var e=r.toLowerCase().trim();return e=(e=e.replace(/[^a-z0-9\s-]/g," ")).replace(/[\s-]+/g,"-")}}});
"use strict";!function(){function e(t){var e={Success:function(e,n){t.globals.flash={message:e,type:"success",keepAfterLocationChange:n}},Error:function(e,n){t.globals.flash={message:e,type:"danger",keepAfterLocationChange:n}}};return t.$on("$locationChangeStart",function(){!function(){var e=t.flash;e&&(e.keepAfterLocationChange?e.keepAfterLocationChange=!1:delete t.flash)}()}),e}e.$inject=["$rootScope"],angular.module("app").factory("AlertService",e)}();
"use strict";!function(){function t(e,i){return function(n){this.GetAll=function(){return e.get(n).then(u,r)},this.GetById=function(t){return e.get(n+"/"+t).then(u,r)},this.Save=function(t){return t._id?e.put(n+"/"+t._id,t).then(u,r):e.post(n,t).then(u,r)},this.Delete=function(t){return e.delete(n+"/"+t).then(u,r)},this.AddMethod=function(t,n){this[t]=function(){return n.apply(this,arguments).then(u,r)}}};function u(t){return t.data}function r(t){var n=t.data&&t.data.Message?t.data.Message:t.data;return i.reject(n)}}t.$inject=["$http","$q"],angular.module("app").factory("DataService",t)}();
"use strict";!function(){function e(e){return new e("/api/pages")}e.$inject=["DataService"],angular.module("app").factory("PageService",e)}();
"use strict";!function(){function t(t){return new t("/api/posts")}t.$inject=["DataService"],angular.module("app").factory("PostService",t)}();
"use strict";!function(){function e(e){return new e("/api/redirects")}e.$inject=["DataService"],angular.module("app").factory("RedirectService",e)}();
"use strict";!function(){function e(t,e){var i=new e("/api/sites");return i.AddMethod("Search",function(e){return e=e||"",t.get("/api/sites/search?q="+e)}),i}e.$inject=["$http","DataService"],angular.module("app").factory("SiteService",e)}();
"use strict";!function(){function e(r,e){var t=new e("/api/users");return t.AddMethod("GetCurrent",function(){return r.get("/api/users/current")}),t.AddMethod("Search",function(e){return e=e||"",r.get("/api/users/search?q="+e)}),t}e.$inject=["$http","DataService"],angular.module("app").factory("UserService",e)}();
"use strict";!function(){function e(e,n,t){var r=this;r.user=null,r.saveUser=function(){n.Save(r.user).then(function(){t.Success("User saved")}).catch(function(e){t.Error(e)})},r.deleteUser=function(){n.Delete(r.user._id).then(function(){e.location="/login"}).catch(function(e){t.Error(e)})},n.GetCurrent().then(function(e){r.user=e})}e.$inject=["$window","UserService","AlertService"],angular.module("app").controller("Account.IndexController",e)}();
"use strict";!function(){function e(e,t,a,n,i){var c=this;c.page={},c.savePage=function(){n.Save(c.page).then(function(){i.Success("Page saved",!0),t.path("/pages")}).catch(function(e){i.Error(e)})},c.deletePage=function(){n.Delete(c.page._id).then(function(){i.Success("Page deleted",!0),t.path("/pages")}).catch(function(e){i.Error(e)})},c.loading=0,e._id?(c.loading+=1,n.GetById(e._id).then(function(e){c.loading-=1,c.page=e})):c.page={publish:!0}}e.$inject=["$stateParams","$location","$filter","PageService","AlertService"],angular.module("app").controller("Pages.AddEditController",e)}();
"use strict";!function(){function e(e){var n=this;n.pages=[],n.loading=!0,e.GetAll().then(function(e){n.loading=!1,n.pages=e})}e.$inject=["PageService"],angular.module("app").controller("Pages.IndexController",e)}();
"use strict";!function(){function t(t,o,e,n){var s=this;s.post={},s.savePost=function(){e.Save(s.post).then(function(){n.Success("Post saved",!0),o.path("/posts")}).catch(function(t){n.Error(t)})},s.deletePost=function(){e.Delete(s.post._id).then(function(){n.Success("Post deleted",!0),o.path("/posts")}).catch(function(t){n.Error(t)})},s.loading=0,t._id?(s.loading+=1,e.GetById(t._id).then(function(t){s.loading-=1,s.post=t})):s.post={publishDate:moment().format("YYYY-MM-DD"),publish:!0}}t.$inject=["$stateParams","$location","PostService","AlertService"],angular.module("app").controller("Posts.AddEditController",t)}();
"use strict";!function(){function t(t){var n=this;n.posts=[],n.loading=!0,t.GetAll().then(function(t){n.loading=!1,n.posts=t})}t.$inject=["PostService"],angular.module("app").controller("Posts.IndexController",t)}();
"use strict";!function(){function e(e,t,r,c,i){var n=this;n.redirect={},n.saveRedirect=function(){c.Save(n.redirect).then(function(){i.Success("Redirect saved",!0),t.path("/redirects")}).catch(function(e){i.Error(e)})},n.deleteRedirect=function(){c.Delete(n.redirect._id).then(function(){i.Success("Redirect deleted",!0),t.path("/redirects")}).catch(function(e){i.Error(e)})},n.loading=0,e._id&&(n.loading+=1,c.GetById(e._id).then(function(e){n.loading-=1,n.redirect=e}))}e.$inject=["$stateParams","$location","$filter","RedirectService","AlertService"],angular.module("app").controller("Redirects.AddEditController",e)}();
"use strict";!function(){function e(e){var t=this;t.redirects=[],t.loading=!0,e.GetAll().then(function(e){t.loading=!1,t.redirects=e})}e.$inject=["RedirectService"],angular.module("app").controller("Redirects.IndexController",e)}();
"use strict";!function(){function e(e,i,t,s,n){var r=this;r.site={},r.saveSite=function(){t.Save(r.site).then(function(){n.Success("Site saved",!0),i.path("/sites")}).catch(function(e){n.Error(e)})},r.deleteSite=function(){t.Delete(r.site._id).then(function(){n.Success("Site deleted",!0),i.path("/sites")}).catch(function(e){n.Error(e)})},r.searchUsers=function(){if(!r.userQuery)return void(r.users=[]);s.Search(r.userQuery).then(function(e){r.users=e}).catch(function(e){n.Error(e)})},r.addUser=function(e){r.site.users=r.site.users||[],r.site.users.push(e),r.userQuery="",r.users=[]},r.removeUser=function(i){r.site.users=r.site.users.filter(function(e){return e._id!==i._id})},r.addDomain=function(){r.site.domains=r.site.domains||[],r.site.domains.push(r.domain),r.domain=""},r.removeDomain=function(i){r.site.domains=r.site.domains.filter(function(e){return e!==i})},r.loading=0,e._id&&(r.loading+=1,t.GetById(e._id).then(function(e){r.loading-=1,r.site=e}))}e.$inject=["$stateParams","$location","SiteService","UserService","AlertService"],angular.module("app").controller("Sites.AddEditController",e)}();
"use strict";!function(){function t(t){var e=this;e.sites=[],e.loading=!0,t.GetAll().then(function(t){e.loading=!1,e.sites=t})}t.$inject=["SiteService"],angular.module("app").controller("Sites.IndexController",t)}();
"use strict";!function(){function e(e,t,s,i,r){var n=this;n.user={},n.saveUser=function(){s.Save(n.user).then(function(){r.Success("User saved",!0),t.path("/users")}).catch(function(e){r.Error(e)})},n.deleteUser=function(){s.Delete(n.user._id).then(function(){r.Success("User deleted",!0),t.path("/users")}).catch(function(e){r.Error(e)})},n.searchSites=function(){if(!n.siteQuery)return void(n.sites=[]);i.Search(n.siteQuery).then(function(e){n.sites=e}).catch(function(e){r.Error(e)})},n.addSite=function(e){n.user.sites=n.user.sites||[],n.user.sites.push(e),n.siteQuery="",n.sites=[]},n.removeSite=function(t){n.user.sites=n.user.sites.filter(function(e){return e._id!==t._id})},n.loading=0,e._id&&(n.loading+=1,s.GetById(e._id).then(function(e){n.loading-=1,n.user=e}))}e.$inject=["$stateParams","$location","UserService","SiteService","AlertService"],angular.module("app").controller("Users.AddEditController",e)}();
"use strict";!function(){function e(e){var n=this;n.users=[],n.loading=!0,e.GetAll().then(function(e){n.loading=!1,n.users=e})}e.$inject=["UserService"],angular.module("app").controller("Users.IndexController",e)}();