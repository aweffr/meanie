<div class="users-add-edit">
    <h1>User Details</h1>
    <form ng-if="!vm.loading">
        <div class="form-group">
            <label for="name">Username</label>
            <input type="text" id="name" class="form-control" ng-model="vm.user.username" required />
        </div>
        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" class="form-control" ng-model="vm.user.password" />
        </div>
        <div ng-show="!vm.user.isSystemAdmin">
            <div class="form-group">
                <label for="siteQuery">Sites</label>
                <input type="text" id="siteQuery" class="form-control" placeholder="Search..." ng-model="vm.siteQuery" ng-change="vm.searchSites()" />
                <div class="popdown" ng-show="vm.sites">
                    <div class="list-group">
                        <a class="list-group-item list-group-item-action" ng-repeat="site in vm.sites" ng-click="vm.addSite(site)">{{site.name}}</a>
                    </div>
                </div>
            </div>
            <div class="form-group" ng-if="vm.user.sites.length">
                <ul>
                    <li ng-repeat="site in vm.user.sites">{{site.name}} - <a class="btn-xs" ng-click="vm.removeSite(site)">Remove</a></li>
                </ul>
            </div>
        </div>
        <div class="checkbox">
            <label>
                <input type="checkbox" ng-model="vm.user.isSystemAdmin"> System Admin
            </label>
        </div>
        <hr />
        <div class="form-group">
            <a class="btn btn-primary" ng-click="vm.saveUser()">Save</a>
            <a class="btn btn-default" href="#/users">Cancel</a>
            <a class="btn btn-danger" ng-click="vm.deleteUser()" ng-show="vm.user._id">Delete</a>
        </div>
    </form>
</div>